@if (!LoginState.Loaded) {
    <h6>Authentifiziere...</h6>
} else {
    if (LoginState.LoggedIn) {
        if (AuthorizedAndMatching is null) {
            @Authorized
        } else {
            if (UserIdClaim == LoginState.User.Id) {
                @AuthorizedAndMatching
            } else {
                if (NotAuthorized is null) {
                    <div>Sie sind nicht dazu befugt, auf diese Ressource zuzugreifen.</div>
                } else {
                    @NotAuthorized
                }
            }
        }
    } else {
        if (NotAuthorized is null) {
            <div>Um auf diese Ressource zuzugreifen müssen Sie sich anmelden.</div>
        } else {
            @NotAuthorized
        }
    }
}


@code {

    [CascadingParameter]
    private LoginState LoginState { get; set; } = default!;
    
    [Parameter]
    public RenderFragment? Authorized { get; set; }
    
    [Parameter]
    public RenderFragment? NotAuthorized { get; set; }
    
    [Parameter]
    public RenderFragment? AuthorizedAndMatching { get; set; }
    
    [Parameter]
    public long? UserIdClaim { get; set; }

    protected override void OnParametersSet() {
        if (Authorized != null && AuthorizedAndMatching != null) {
            throw new InvalidOperationException($"Do not specify both '{nameof(Authorized)}' and '{nameof(AuthorizedAndMatching)}'");
        }
        if (AuthorizedAndMatching != null && UserIdClaim == null) {
            throw new InvalidOperationException($"'{nameof(AuthorizedAndMatching)}' requires '{nameof(UserIdClaim)}'");
        }

    }

}
